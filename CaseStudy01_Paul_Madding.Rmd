---
title: "A Study of Beers and Breweries in the US"
author: "Ryan Paul & Chad Madding"
date: "October 18, 2018"
output:
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

*With a strong presence across the 50 states and the District of Columbia, craft breweries are a vibrant and flourishing economic force at the local, state and national level. As consumers continue to demand a wide range of high quality, full-flavored beers, small and independent craft brewers are meeting this growing demand with innovative offerings, creating high levels of economic value in the process.*

**Bart Watson**, Chief Economist for the Brewers Association

https://www.brewersassociation.org/statistics/economic-impact-data/

We have been hired to gain incite into breweries in the United Stated. We will focus on providing information to a national brewery for them to look into investing in the craft brewery industry.

## Data

The data for this study will consist of two databases collected and supplied by our client.

**Data/Beers.csv**

| Variable | Description |
| -------- | ----------- |
| Name | name of beer |
| BeerID | unique id number of the beer |
| ABV | alcohol by volume of beer |
| IBU | international bitterness units of the beer |
| Style | style of beer |
| Ounces | unit of measurement for the beer by oz |

**Data/Breweries.csv**

| Variable | Description |
| -------- | ----------- |
| Name | name of beer |
| Brew_ID | unique identification number of the brewery |
| Name | name of brewery |
| City | city where brewery is located |
| State | state where brewery is located |

## Folder Information

This will be information about folders

## Questions our client would like addresses

Load libraries
```{r library, echo=FALSE}
#load libraries
library(dplyr)
library(plyr)
library(ggplot2)
```


Read the two databases into R
```{r read data, echo=TRUE}
#read in the two databases
breweries <- read.csv("Data/Breweries.csv")
beers <- read.csv("Data/Beers.csv")
```


   1. How many breweries are present in each state?
```{r breweries state, echo=TRUE}
#count breweries in each state
brew_state <- table(breweries$State)
brew_state
```

   2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.
```{r merge data, echo=TRUE}
#looking at each database to see problems before the merge
head(beers)
head(breweries)
#rename Brew_ID to Brewery_id to merge data
colnames(breweries)[1] <- "Brewery_id"
#both have a "Name" two for different groups
#rename Name to Brewery_Name
colnames(breweries)[2] <- "Brewery_Name"
#rename Name to Beer_Name
colnames(beers)[1] <- "Beer_Name"
#merge both data sets
brew_beer <- merge.data.frame(beers, breweries, by = "Brewery_id")
#print the first 6 observations
head(brew_beer, 6)
#print the last 6 observations
tail(brew_beer, 6)
```

   3. Report the number of NA's in each column.
```{r count NAs, echo=TRUE}
#use colSum to sum up the NA's in each column
colSums(is.na(brew_beer))

```

   4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
```{r Compute the median, echo=TRUE}
#Compute the median alcohol content (ABV) by state
medABV <- tapply(brew_beer$ABV, brew_beer$State, function(x) median = median(x, na.rm = TRUE))
#Compute the median international bitterness unit (IBU) by state
medIBU <- tapply(brew_beer$IBU, brew_beer$State, function(x) median = median(x, na.rm = TRUE))

#plot a bar chart to compare ABV and IBU
#convert AVB and IBU to a data frame
medABVbar <- data.frame(medABV)
medIBUbar <- data.frame(medIBU)

#add a State column to ABV and IBU
medABVbar$State <- rownames(medABVbar)
medIBUbar$State <- rownames(medIBUbar)

#sort ABV in desending order
medABVbar<- medABVbar[order(medABV), ]
#sort IBU in desending order
medIBUbar<- medIBUbar[order(medIBU), ]

#plot a bar chart for ABV
ggplot(na.omit(medABVbar), aes(x=reorder(medABVbar$State, medABVbar$medABV), y=medABVbar$medABV)) +
  geom_bar(stat="identity", color="white", fill="blue") +
  ylab("Alcohol Content") + xlab("State") +
  ggtitle("Median ABV by State") +
  coord_flip() + theme(plot.title = element_text(hjust=0.5), text = element_text(size=7.5))

#Remove SD from the list due to no IBU data
medIBUbar <- medIBUbar[-grep("SD", medIBUbar$State),]
#plot a bar chart for IBU
ggplot((medIBUbar), aes(x=reorder(medIBUbar$State, medIBUbar$medIBU), y=medIBUbar$medIBU)) +
  geom_bar(stat="identity", color="white", fill="blue") +
  ylab("IBU") + xlab("State") +
  ggtitle("Median IBU by State") +
  coord_flip() + theme(plot.title = element_text(hjust=0.5), text = element_text(size=7.5))

```

   5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
```{r max ABV and IBU, echo= TRUE}
brew_beer$State[which.max(brew_beer$ABV)]
brew_beer$State[which.max(brew_beer$IBU)]
```

   6. Summary statistics for the ABV variable.
```{r summary ABV, echo= TRUE}
summary(brew_beer$ABV)

```

   7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.
```{r scatter plot, echo=TRUE}
#ggplot to check for correlation
ggplot(brew_beer, aes(x = IBU, y = ABV)) + geom_point(na.rm=TRUE)+geom_smooth(method=lm,se=FALSE, na.rm=TRUE)

```

The scatterplot looks to show a signaficly positive corrlation.

Looking at the numbers below we can see a very signatific correlation between tha alochol content (ABV) and the bitterness (IBU) of a beer. This is observational data so even with the corrlation we can not infer anything to the larger population in reguards to ABV and IBU.
```{r Pearson, echo+TRUE}
# Pearson to check for correlation 
cor.test(brew_beer$ABV, brew_beer$IBU, method = "pearson")
```

## Conclusion

Summarize your findings from this exercise.

**sessionInfo**

R version 3.5.1 (2018-07-02)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)
